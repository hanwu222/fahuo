# 支付宝开放平台配置教程

本教程将指导您完成支付宝开放平台的注册、应用创建和密钥配置，实现**自动发货**功能。

---

## 📋 准备工作

在开始前，请确保您有：
- ✅ 支付宝经营码（商家账号）
- ✅ 营业执照（个体户或企业均可）
- ✅ 可用于接收验证码的手机

---

## 步骤一：注册支付宝开放平台

### 1.1 访问开放平台
打开 [支付宝开放平台](https://open.alipay.com)，点击右上角 **"登录"**

### 1.2 使用商家账号登录
- 使用您申请经营码的**支付宝账号**登录
- 如果是企业，使用企业支付宝账号

### 1.3 完成入驻
- 首次登录需要完成开发者入驻
- 按提示填写信息并提交审核（通常几分钟内通过）

---

## 步骤二：创建应用

### 2.1 进入控制台
登录后，点击顶部 **"控制台"** → **"我的应用"** → **"创建应用"**

### 2.2 选择应用类型
选择 **"网页/移动应用"** → **"自用型应用"**

### 2.3 填写应用信息
| 字段 | 填写内容 |
|------|----------|
| 应用名称 | 成品账号自助购买 |
| 应用图标 | 上传一个图标（可选） |
| 应用简介 | 数字商品自动发货系统 |

点击 **"确认创建"**

### 2.4 记录AppID
创建成功后，记录您的 **AppID**（格式如：2021000000000000）

---

## 步骤三：添加功能

### 3.1 添加"当面付"功能
在应用详情页，点击 **"产品绑定"** → **"绑定产品"**

搜索并添加：
- ✅ **当面付**（扫码支付）

### 3.2 提交审核
添加功能后，点击 **"提交审核"**

> 审核通常在1个工作日内完成

---

## 步骤四：配置密钥

### 4.1 生成密钥
1. 下载 [支付宝开放平台密钥工具](https://opendocs.alipay.com/common/02kipk)
2. 打开工具，选择 **"RSA2"** → **"PKCS1"** → 点击 **"生成密钥"**
3. 保存生成的两个文件：
   - `应用私钥.txt` - **保密！不要泄露给任何人**
   - `应用公钥.txt` - 需要上传到支付宝

### 4.2 上传公钥
1. 回到支付宝开放平台的应用详情页
2. 点击 **"开发设置"** → **"接口加签方式"** → **"设置"**
3. 选择 **"公钥"** 模式
4. 将 `应用公钥.txt` 的内容粘贴进去
5. 点击保存，系统会返回一个 **"支付宝公钥"**

### 4.3 保存配置信息
请将以下信息记录下来，后续配置需要用到：

| 配置项 | 您的值 |
|--------|--------|
| AppID | `填写您的AppID` |
| 应用私钥 | `私钥文件内容` |
| 支付宝公钥 | `系统返回的公钥` |

---

## 步骤五：注册Vercel（免费托管）

### 5.1 访问Vercel
打开 [Vercel官网](https://vercel.com)，点击 **"Sign Up"**

### 5.2 选择注册方式
推荐使用 **GitHub** 账号登录（如果没有，先注册一个GitHub账号）

### 5.3 完成注册
按提示完成账号创建，个人免费版完全够用

---

## 步骤六：注册Supabase（免费数据库）

### 6.1 访问Supabase
打开 [Supabase官网](https://supabase.com)，点击 **"Start your project"**

### 6.2 用GitHub登录
使用GitHub账号登录

### 6.3 创建项目
1. 点击 **"New Project"**
2. 填写信息：
   - 项目名称：`auto-delivery`
   - 数据库密码：设置一个密码（请记住！）
   - 区域：选择 `Northeast Asia (Tokyo)` 或其他亚洲区域
3. 点击创建

### 6.4 记录配置信息
项目创建后，在左侧点击 **"Settings"** → **"API"**，记录：

| 配置项 | 位置 |
|--------|------|
| Project URL | `https://xxx.supabase.co` |
| anon public key | API Keys 区域 |

---

## ✅ 完成！

完成以上步骤后，请将以下信息告诉我：

1. **支付宝 AppID**
2. **Supabase Project URL**
3. **Supabase anon key**

> ⚠️ **不要分享您的应用私钥！** 私钥需要配置到Vercel环境变量中，我会指导您操作。

我将帮您：
1. 升级代码接入支付宝当面付API
2. 创建数据库表结构
3. 部署到Vercel
4. 测试完整的自动发货流程
